jQuery.fn.viwcaio_get_variations=function(i){return new viwcaio_get_variation(this,i),this};var viwcaio_get_variation=function(i,t){this.wc_ajax_url=t.wc_ajax_url||"",this.form=i,this.product_id=parseInt(i.data("product_id")),this.variations=i.data("product_variations")||"",this.is_ajax=!this.variations,this.xhr=!1;let a={};i.on("viwcaio_check_variations",{viwcaio_get_variation:this},this.find_variation),i.on("change","select",{viwcaio_get_variation:this},this.onChange),i.find("select").each(function(){a[jQuery(this).data("attribute_name")]=jQuery(this).val()||""}),this.current_attr=a,setTimeout(function(){i.trigger("viwcaio_check_variations")},100)};viwcaio_get_variation.prototype.onChange=function(i){let t=i.data.viwcaio_get_variation,a=t.form;a.find('input[name="variation_id"], input.variation_id').val("").trigger("change"),t.current_attr[jQuery(this).data("attribute_name")]=jQuery(this).val()||"",t.is_ajax?a.trigger("viwcaio_check_variations"):(a.trigger("woocommerce_variation_select_change"),a.trigger("viwcaio_check_variations")),a.trigger("woocommerce_variation_has_changed")},viwcaio_get_variation.prototype.find_variation=function(i){let t=i.data.viwcaio_get_variation,a=null,e=!1,o=t.current_attr,r=t.form,c=t.variations;if(jQuery.each(o,function(i,t){if(!t)return e=!0,!1}),e)return t.update_attributes(o,c,r,t),t.show_variation(t,null,r),!1;t.is_ajax?(t.xhr&&t.xhr.abort(),c?(jQuery.each(c,function(i,e){if(t.check_is_equal(o,e.attributes))return a=e,!1}),a?t.show_variation(t,a,r):c.length<parseInt(r.data("variation_count")||0)?t.call_ajax(o,c,r,t):t.show_variation(t,a,r)):(c=[],t.call_ajax(o,c,r,t))):(jQuery.each(c,function(i,e){if(t.check_is_equal(o,e.attributes))return a=e,!1}),t.update_attributes(o,c,r,t),t.show_variation(t,a,r))},viwcaio_get_variation.prototype.update_attributes=function(i,t,a,e){if(e.is_ajax)return!1;a.find("select").each(function(a,o){let r,c=jQuery(o),n=c.data("attribute_name")||c.attr("name"),s=c.data("show_option_none"),d=c.val()||"",v=!0,l=jQuery("<select/>"),_=":gt(0)";if(!c.data("attribute_html")){let i=c.clone();i.find("option").removeAttr("disabled attached selected"),c.data("attribute_options",i.find("option"+_).get()),c.data("attribute_html",i.html())}l.html(c.data("attribute_html"));let u=jQuery.extend(!0,{},i);u[n]="";let p=[];for(let i=0;i<t.length;i++){let a=t[i];e.check_is_equal(u,a.attributes)&&p.push(a)}for(let i in p){if(void 0===p[i])continue;let t=p[i].attributes;for(let a in t){if(!t.hasOwnProperty(a))continue;let e=t[a],o="";if(a===n)if(p[i].variation_is_active&&(o="enabled"),e){e=jQuery("<div/>").html(e).text();let i=l.find("option");if(i.length)for(let t=0,a=i.length;t<a;t++){let a=jQuery(i[t]);if(e===a.val()){a.addClass("attached "+o);break}}}else l.find("option:gt(0)").addClass("attached "+o)}}r=l.find("option.attached").length,d&&(v=!1,0!==r&&l.find("option.attached.enabled").each(function(){var i=jQuery(this).val();if(d===i)return v=!0,!1})),r>0&&d&&v&&"no"===s&&(l.find("option:first").remove(),_=""),l.find("option"+_+":not(.attached)").remove(),c.html(l.html()),c.find("option"+_+":not(.enabled)").prop("disabled",!0),d?v?c.val(d):c.val("").change():c.val("")}),a.trigger("woocommerce_update_variation_values")},viwcaio_get_variation.prototype.call_ajax=function(i,t,a,e){i.product_id=e.product_id,e.xhr=jQuery.ajax({url:e.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:i,beforeSend:function(){a.closest(".vi-wcaio-sb-container").addClass("vi-wcaio-container-loading"),a.closest(".vi-wcaio-va-cart-form-wrap").addClass("vi-wcaio-container-loading")},success:function(o){e.show_variation(e,o,a),o&&(t[t.length||0]=o),delete i.product_id},complete:function(){a.closest(".vi-wcaio-sb-container").removeClass("vi-wcaio-container-loading"),a.closest(".vi-wcaio-va-cart-form-wrap").removeClass("vi-wcaio-container-loading")}})},viwcaio_get_variation.prototype.show_variation=function(i,t,a){if(a.hasClass("vi-wcaio-sb-cart-swatches"))if(a.closest(".vi-wcaio-sb-wrap").find(".vi-wcaio-sb-product-title").attr("data-product_name",""),t){let e=!0;if(t.is_purchasable&&t.is_in_stock&&t.variation_is_visible||(e=!1),t.price_html&&(a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-price-wrap .vi-wcaio-sb-product-price").length?a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-price-wrap .vi-wcaio-sb-product-price").html(t.price_html):a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-price-wrap").append('<span class="vi-wcaio-sb-product-price">'+t.price_html+"</span>"),a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-price-wrap > span:not(.vi-wcaio-sb-product-price)").addClass("vi-wcaio-disabled")),a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-img").attr({src:t.image.thumb_src}),e){i.set_add_to_cart(t.variation_id,a),a.find(".vi-wcaio-product-bt-atc").removeClass("vi-wcaio-button-swatches-disable");let e=[],o=a.closest(".vi-wcaio-sb-wrap").find(".vi-wcaio-sb-product-title");a.find("select").each(function(i,t){e.push(jQuery(t).find("option:selected").text())}),o.attr("data-product_name",o.html()+" - "+e)}else i.set_add_to_cart("",a),a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-price-wrap span.vi-wcaio-sb-product-price").remove(),a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-price-wrap > span:not(.vi-wcaio-sb-product-price)").removeClass("vi-wcaio-disabled"),a.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable");a.trigger("viwpvs_show_variation",[t,e])}else i.set_add_to_cart("",a),a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-img").attr({src:a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-img").data("src")}),a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-price-wrap > span:not(.vi-wcaio-sb-product-price)").removeClass("vi-wcaio-disabled"),a.closest(".vi-wcaio-sb-container").find(".vi-wcaio-sb-product-price-wrap span.vi-wcaio-sb-product-price").remove(),a.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable"),a.trigger("viwpvs_hide_variation");else if(a.hasClass("vi-wcaio-va-cart-swatches"))if(t){let e=!0;t.is_purchasable&&t.is_in_stock&&t.variation_is_visible||(e=!1),e?(i.set_add_to_cart(t.variation_id,a),a.find(".vi-wcaio-product-bt-atc").removeClass("vi-wcaio-button-swatches-disable")):(i.set_add_to_cart("",a),a.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable")),a.trigger("viwpvs_show_variation",[t,e])}else i.set_add_to_cart("",a),a.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable"),a.trigger("viwpvs_hide_variation")},viwcaio_get_variation.prototype.set_add_to_cart=function(i,t){i=i||0,t.find(".variation_id").val(i)},viwcaio_get_variation.prototype.check_is_equal=function(i,t){let a=Object.getOwnPropertyNames(i),e=Object.getOwnPropertyNames(t);if(a.length!==e.length)return!1;for(let e=0;e<a.length;e++){let o=a[e],r=i[o],c=t[o];if(void 0!==r&&void 0!==c&&0!==r.length&&0!==c.length&&r!==c)return!1}return!0};